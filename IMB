// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© lequochieu284

//@version=5
strategy("chiec luoc IMB", overlay=true)

risk = input(title="risk per trade %:", defval=0.5)
rrr = input(defval=3.1, title ="ti le RR:")

var highestHigh = 0.0
var lowestLow = 999999.0
var checkBreakHigh = 0
var checkBreakLow = 0
var checkCountDown = 0
var checkCountUp = 0
var tmpNewHigh = 0.0
var tmpNewLow = 999999.0

// uptrend
if high > highestHigh
    highestHigh := high
    if checkCountDown >=2
        checkBreakHigh := checkBreakHigh + 1
        lowestLow := tmpNewLow
        checkBreakLow := 0
        checkCountDown := 0
        tmpNewLow := 999999
else
    tmpNewLow := low < tmpNewLow ? low : tmpNewLow
    if close < open
        checkCountDown := checkCountDown + 1


// dow trend
if low < lowestLow
    lowestLow := low
    if checkCountUp >=2
        checkBreakLow := checkBreakLow + 1
        highestHigh := tmpNewHigh
        checkBreakHigh := 0
        checkCountUp := 0
        tmpNewHigh := 0
else
    tmpNewHigh := high > tmpNewHigh ? high: tmpNewHigh
    if close > open
        checkCountUp := checkCountUp + 1



//plotshape(checkBreakLow >= 2 ? checkBreakLow : na, style = shape.labeldown, color=color.red, size=size.tiny)
//plotshape(checkBreakLow == 1 ? checkBreakLow : na, style = shape.labeldown, color=color.red, size=size.tiny)
//plotshape(checkBreakHigh == 2 ? checkBreakHigh : na, style = shape.labelup, color=color.green, size=size.tiny)
//plot(countHigh, title = "countHigh")
//plot(countLow,  title = "countLow")
plot(checkBreakHigh,  title = "checkBreakHigh", color = color.green)
plot(checkBreakLow,  title = "checkBreakLow", color = color.red)
//plot(tmpNewHigh, title = "tmpNewHigh", color = color.yellow)
//plot(tmpNewLow,  title = "tmpNewLow",  color = color.gray)

plot(highestHigh, linewidth = 2, style = plot.style_circles, color = color.green, offset = 0, title = "highestHigh")
plot(lowestLow, linewidth = 2, style = plot.style_circles, color = color.red, offset = 0, title = "lowestLow")



